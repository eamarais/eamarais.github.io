<!doctype html>
<html>
<head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-L03HTPL2E2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-L03HTPL2E2');
</script>
<meta charset="utf-8">
<title>Rocket Launch Emissions</title>
</head>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head profile="http://gmpg.org/xfn/11">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Atmospheric Composition and Air Quality Group</title>
<link rel="stylesheet" href="style.css" type="text/css" media="screen" />
<style type="text/css" media="screen">
	#page { background: url("./themes/default/images/kubrickbgwide.jpg") repeat-y top; border: none; }
</style>
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/globe.gl"></script>
	<!-- begin gallery scripts -->

    <link rel="stylesheet" href="./plugins/featured-content-gallery/css/jd.gallery.css.php" type="text/css" media="screen" charset="utf-8"/>

	<link rel="stylesheet" href="./plugins/featured-content-gallery/css/jd.gallery.css" type="text/css" media="screen" charset="utf-8"/>

	<script type="text/javascript" src="./plugins/featured-content-gallery/scripts/mootools.v1.11.js"></script>

	<script type="text/javascript" src="./plugins/featured-content-gallery/scripts/jd.gallery.js.php"></script>

	<script type="text/javascript" src="./plugins/featured-content-gallery/scripts/jd.gallery.transitions.js"></script>

	<!-- end gallery scripts -->
	
<!---<style type="text/css"></style>
#headerimg h1 a, #headerimg h1 a:visited, #headerimg .description { color: #FFFFFF; }
--->

</head>

<body>

<div id="page">

<!---<style>.color-box{background-color: white; width: 917px; height: 42px; margin-left:32px; margin-top:-52px; border-color:black; border-style:solid; border-width:1px}</style>
<style>.transparent-box{background-color: transparent; width: 917px; height: 162px; margin-left:32px; margin-top:-42px; border-color:transparent}</style>--->
	
<div id="header">

	<div id="headerimg">
		
		<h1><a style="color:black" href="http://maraisresearchgroup.co.uk/"><div class="transparent-box">Atmospheric Composition and Air Quality Group</div></a></h1>
		<h1><a href="http://maraisresearchgroup.co.uk/"><div class="transparent-box"></div></a></h1>

		<div class="description"></div>
	</div>

<!--Navigation bar-->
	<div id="navmenu">
		<iframe src="./nav.html" onload="this.before((this.contentDocument.body||this.contentDocument).children[0]);this.remove()"></iframe>
	</div>

</div>

<hr />


<div id="content" class="widecolumn">

	<div class="post" id="post-3">
			<span id="top"><h2>Emissions from Rocket Launches</h2>
				<div class="entry">	
				
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
					
	<style>

		.filter-container {
			display: flex;
			justify-content: space-around;
			align-items: center;
			padding: 10px;
			list-style-type: circle;
		}

		.filter {
			position: relative;
			background: #143d59;
			color: whitesmoke;
			font-size: 1rem;
			padding: 0.5rem;
			height: 15px;
			border-radius: 5px;
		}

		/* Bold label */
		.filter label {
			font-size: 16px; /* Adjust size if needed */
		}

		/* Hide dropdown initially */
		.dropdown ul {
			display: none;
			position: absolute;
			left:50%;
			transform: translateX(-50%);
			list-style-type: none;
			background-color: #8dc4ee;
			max-height: 300px;
			overflow-y: auto;
			width: auto;
			min-width: 150px; /* Ensure a minimum width */
			white-space: nowrap;
			border-radius: 5px;
			z-index: 100;
			top: 15px;
		}

		/* Show dropdown when hovering */
		.filter:hover .dropdown ul {
			text-align: left;
			display: inline-block;
		}

		.dropdown li:hover {
			background-color: #143d59;
			list-style-type: none;
		}

		.dropdown label {
			font-size: 14px; /* Smaller font size */
			font-weight: normal !important; /* Prevent bold */
			display: flex;
			align-items: center;
			gap: 15px; /* Space between checkbox and text */
			padding: 0px 10px; /* Add padding (top-bottom, left-right) */
		}

		.wrap-text {
			white-space: normal;
			word-wrap: break-word;
			max-width: 500px; /* Adjust the width as needed */
		}
	
		/* Container to align the maps side by side */
		.map-container {
			display: flex;
			justify-content: space-between;
			gap: 20px;
			padding: 20px;
			/* Ensure container size is constrained */
			width: 100%; /* or set a specific width like 80% if desired */
			height: 100%; /* You can adjust this as needed */
			box-sizing: border-box; /* Ensure padding is included in the container size */
		}

		/* Prevent flex items from stretching */
		.globe-container {
			flex-shrink: 0;
			flex-grow: 0;
			width: 100%; /* Ensure it fills the available space */
			height: 100%; /* Ensure it fills the available height */
		}

		/* Prevent flex items from stretching */
		.bar-container {
			width: 100%; /* Ensure it fills the available space */
			height: 100%; /* Ensure it fills the available height */
		}

		/* Style for the tabs */
		.tabs {
            display: flex;
            cursor: pointer;
            margin-bottom: 10px;
        }

        .tab {
            padding: 10px 20px;
            margin-right: 10px;
            background-color: #f0f0f0;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        .tab:hover {
            background-color: #ddd;
        }

        .active-tab {
            background-color: #ccc;
            font-weight: bold;
        }

		/* Initially hide both containers */
		.globe-container, .map-container, .bar-container {
			display: none;
        }

        /* Show active container */
        .active-container {
            display: block;
        }

		.map {
			flex: 1;
			height: 100%;
		}

		.globe {
			flex: 1;
			height: 100%;
		}

		.bar {
			width: 100%;
		}

		/* Container to align the tables side by side */
		.table-container {
			display: flex;
			justify-content: space-between;
			gap: 20px;
		}

		/* Table styling */
		table {
			width: 100%;
			margin-top: 20px;
			border-collapse: collapse;
			padding: 10px;
			white-space: nowrap;
		}

		th, td {
			padding: 10px;
			text-align: left;
			border: 1px solid #ddd;
			white-space: nowrap;
		}

		th {
			background-color: #f4f4f4;
		}

		tfoot {
			font-weight: bold;
			background-color: #f9f9f9;
		}

		.faq-item {
			display: block;

			/*width: 38vw;
			min-width: 350px;*/
			margin-top: 0.5rem;
		}
		.item-question {
			background: #143d59;
			color: whitesmoke;
			font-size: 1rem;
			padding: 0.5rem;
			display: flex;
			justify-content: space-between;
			align-items: center;
		}
		.question-text {
			display: inline-block;
		}
		.arrows-container {
			margin: 0.4rem;
		}
		.item-answer {
			display: none;
			color: rgb(0, 0, 0);
			padding: 2rem;
		}
		.close {
			display: none;
		}

		.show-answer .item-answer {
			display: block;
			background: #8dc4ee;
		}
		.show-answer .close {
			display: inline;
		}
		.show-answer .expand {
			display: none;
		}
	</style>

		<div class="entry">
			
			<br>
			Welcome to this website from the UCL Atmospheric Composition and Air Quality Group detailing the emissions from rocket launches at the start of the megaconstellation era. The Globe and Map views show the location and ID of each rocket launch in the selected time window. The Bar view shows the total emissions generated by all rocket launches in the selected time window. For more information, see the <a href="#faqs-container">FAQs</a>  at the bottom of this page.
			<br>
			<br>

			Please select a date during 2020-2022 (2023-2024 will be released shortly).
			<br>
			<label>Start Date: <input type="date" id="datePicker1" name="datePicker1"></label>
			<label>End Date: <input type="date" id="datePicker2" name="datePicker2"></label><br />
			<br>

			<div class="filter-container">
				<div class="filter">
					<label>Launch Site</label>
					<div class="dropdown" id="locationFilter">
						<ul></ul>
					</div>
				</div>
			
				<div class="filter">
					<label>Launch Vehicle</label>
					<div class="dropdown" id="rocketFilter">
						<ul></ul>
					</div>
				</div>
			
				<div class="filter">
					<label>Megaconstellation</label>
					<div class="dropdown" id="smcFilter">
						<ul></ul>
					</div>
				</div>
				
				<button id="applyFilters">Apply Filters</button>

			</div>
			<br>

			<!-- Tabs for globe and map -->
			<div class="tabs">
				<div class="tab" id="globe-tab" onClick="toggleContainer('globe')">Globe</div>
				<div class="tab" id="map-tab" onClick="toggleContainer('map')">Map</div>
				<div class="tab" id="bar-tab" onClick="toggleContainer('bar')">Bar</div>
			</div>

			<!-- Globe container -->
			<div id="globe-container" class="globe-container">
				<div id="globeplot" class="globe"></div> <!-- First globe container -->
			</div>

			<!-- Map containers -->
			<div id="map-container" class="map-container">
				<div id="map1" class="map"></div> <!-- Map container -->
			</div>
			
			<div id="bar-container" class="bar-container">
				<div id="bar1" class="bar"></div> <!-- Bar container -->
			</div>

			<!-- Table for Launch Locations -->
			<div class="table-container">
				<div>
					<h3>Launch Information (emissions in tonnes, time in UTC). SMC = Satellite Megaconstellation.</h3>
					<table id="launchTable">
						<thead>
							<tr>
								<th>Date</th>
								<th>ID</th>
								<th>Time</th>
								<th>Launch Site</th>
								<th>Rocket</th>
								<th>SMC</th>
								<th>BC</th>
								<th>CO</th>
								<th>CO<sub>2</sub></th>
								<th>H<sub>2</sub>O</th>
								<th>Al<sub>2</sub>O<sub>3</sub></th>
								<th>Cl<sub>y</sub></th>
								<th>NO<sub>x</sub></th>
							</tr>
						</thead>
						<tbody id="launchTableBody">
							<!-- Dynamic rows for launch locations will be inserted here -->
						</tbody>
						<tfoot id="launchTableFoot">
							<!-- Totals for launches -->
						</tfoot>
					</table>
				</div>
				
			</div>

			<script>

				// Initialize with the globe container active
				toggleContainer('globe');

			    // Initialize the default dates 
				let startDate = '2020-01-01';
				let endDate = '2020-02-01';

				let autoRotate = true; // Flag to control rotation
				let lastInteractionTime = Date.now(); // Track last user interaction

				let globe;

				function rotateGlobe() {
					if (!autoRotate || !globe) return; // Stop rotation if the user interacted
					const POV = globe.pointOfView();
					globe.pointOfView({ lat: POV.lat, lng: POV.lng + 0.2 , altitude: 1.9}, 10); // Adjust speed if needed

					requestAnimationFrame(rotateGlobe);
				}

				// ** Detect User Interaction **
				const stopRotation = () => {
					autoRotate = false;
					lastInteractionTime = Date.now();
				};

				// Resume rotation after a period of inactivity
				function checkInactivity() {
					if (Date.now() - lastInteractionTime > 2000) { // 2 sec inactivity
						autoRotate = true;
						rotateGlobe();
					}
					setTimeout(checkInactivity, 2000);
				}

				function populateFilters(launches) {
					// Get unique values from filtered_launches for each filter
					const locations = [...new Set(launches.text)];
					const rockets = [...new Set(launches.rocket)];
					const smcValues = [...new Set(launches.smc)];

					// Function to populate checkboxes inside a given filter dropdown
					function populateCheckboxes(filterId, values) {
						const dropdown = document.getElementById(filterId);
						const ul = dropdown.querySelector('ul');
						ul.innerHTML = ''; // Clear any previous entries

						values.forEach(value => {
							const li = document.createElement('li');
							li.innerHTML = `<label><input type="checkbox" value="${value}" /> ${value}</label>`;
							ul.appendChild(li);
						});
					}

					// Populate each filter
					populateCheckboxes('locationFilter', locations);
					populateCheckboxes('rocketFilter', rockets);
					populateCheckboxes('smcFilter', smcValues);
				}

				function filterlaunches(all_launches) {

					function getSelectedfilters(filter) {
						const var_filter = document.getElementById(filter);
						const checkboxes = var_filter.querySelectorAll('input[type="checkbox"]:checked');
						return Array.from(checkboxes).map(checkbox => checkbox.value);
					}

					// Get selected values from each filter
					const selectedLocations = getSelectedfilters('locationFilter');
					const selectedRockets   = getSelectedfilters('rocketFilter');
					const selectedSmc       = getSelectedfilters('smcFilter');

					// Find indices to keep based on selected filters
					let indicesToKeep = [...Array(all_launches.date.length).keys()];  // All indices initially

					// Filter based on location
					if (selectedLocations.length > 0) {
						indicesToKeep = indicesToKeep.filter(i => selectedLocations.includes(all_launches.text[i]));
					}

					// Filter based on rocket
					if (selectedRockets.length > 0) {
						indicesToKeep = indicesToKeep.filter(i => selectedRockets.includes(all_launches.rocket[i]));
					}

					// Filter based on smc
					if (selectedSmc.length > 0) {
						indicesToKeep = indicesToKeep.filter(i => selectedSmc.includes(all_launches.smc[i]));	
					}

					// Filter the column arrays using the indicesToKeep
					const filteredData = {
						date: indicesToKeep.map(i => all_launches.date[i]),
						time: indicesToKeep.map(i => all_launches.time[i]),
						lat: indicesToKeep.map(i => all_launches.lat[i]),
						lon: indicesToKeep.map(i => all_launches.lon[i]),
						text: indicesToKeep.map(i => all_launches.text[i]),
						id: indicesToKeep.map(i => all_launches.id[i]),
						rocket: indicesToKeep.map(i => all_launches.rocket[i]),
						smc: indicesToKeep.map(i => all_launches.smc[i] ? "Yes" : "No"),
						BC: indicesToKeep.map(i => all_launches.BC[i]),
						CO: indicesToKeep.map(i => all_launches.CO[i]),
						CO2: indicesToKeep.map(i => all_launches.CO2[i]),
						H2O: indicesToKeep.map(i => all_launches.H2O[i]),
						Al2O3: indicesToKeep.map(i => all_launches.Al2O3[i]),
						Cly: indicesToKeep.map(i => all_launches.Cly[i]),
						NOx: indicesToKeep.map(i => all_launches.NOx[i]),
					};

					// Update the visualizations with the filtered data
					updateVisualizations(filteredData);
				}

				// Function to toggle containers
				function toggleContainer(containerType) {
					// Reset classes for all tabs and containers
					document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active-tab'));
					document.querySelectorAll('.globe-container, .map-container, .bar-container').forEach(container => container.classList.remove('active-container'));

					// Add active class to the clicked tab
					if (containerType === 'globe') {
						document.getElementById('globe-tab').classList.add('active-tab');
						document.getElementById('globe-container').classList.add('active-container');
					} else if (containerType === 'map') {
						document.getElementById('map-tab').classList.add('active-tab');
						document.getElementById('map-container').classList.add('active-container');
					} else if (containerType === 'bar') {
						document.getElementById('bar-tab').classList.add('active-tab');
						document.getElementById('bar-container').classList.add('active-container');
					}
				}
				
				async function fetchEventsData() {
					try {
						// Fetch the data from the API (replace with your actual API URL)
						const response1 = await fetch(`https://cbarker.pythonanywhere.com/api/launches?start_date=${startDate}&end_date=${endDate}`); // Replace with your actual API URL
						const launchData = await response1.json();
						
						all_launches = {
							date: [],
							time: [],
							lat: [],
							lon: [],
							text: [],
							id: [],
							rocket: [],
							smc: [],
							BC: [],
							CO: [],
							CO2: [],
							H2O: [],
							Al2O3: [],
							Cly: [],
							NOx: []
						};

						Object.keys(launchData).forEach(date => {
							launchData[date].launches.forEach(launch => {
								all_launches.date.push(launch.date);
								all_launches.time.push(launch.time)
								all_launches.lat.push(parseFloat(launch.lat));
								all_launches.lon.push(parseFloat(launch.lon));
								all_launches.text.push(launch.location);
								all_launches.id.push(launch.id);
								all_launches.rocket.push(launch.rocket);
								all_launches.smc.push(launch.smc.toString());
								all_launches.BC.push(launch.emissions.BC);
								all_launches.CO.push(launch.emissions.CO);
								all_launches.CO2.push(launch.emissions.CO2);
								all_launches.H2O.push(launch.emissions.H2O);
								all_launches.Al2O3.push(launch.emissions.Al2O3);
								all_launches.Cly.push(launch.emissions.Cly);
								all_launches.NOx.push(launch.emissions.NOx);
							});
						});
						
						populateFilters(all_launches);
						updateVisualizations(all_launches);

					} catch (error) {
						console.error('Error fetching or processing the events data:', error);
					}
				}

				function updateVisualizations(filtered_launches) {
					updateTables(filtered_launches);
					updateMaps(filtered_launches);
					updateGraph(filtered_launches);
					updateGlobe(filtered_launches);
				}

				function updateGlobe(filtered_launches) {
					
					const MAX_POINTS_PER_LINE = 2; // Less points for a vertical launch
					const MAX_STEP_ALT = 0.1; // Control the altitude change

					const gData = filtered_launches.lat.map((latitude, index) => {
						const longitude = filtered_launches.lon[index];
						let alt = 0;
						let path = [[latitude, longitude, alt]];

						// You can adjust the number of points and the altitude increment to create the path
						for (let i = 0; i < MAX_POINTS_PER_LINE; i++) { // Adjust this for more points in the path
							alt += MAX_STEP_ALT; // Increase the altitude
							path.push([latitude, longitude, alt]);
						}
						return {
							path: path,
							label: filtered_launches.id[index]  // Store the launch ID here
						};
					});

					globe = new Globe(document.getElementById('globeplot'))
					.globeImageUrl('https://cdn.jsdelivr.net/npm/three-globe/example/img/earth-blue-marble.jpg')
					.bumpImageUrl('https://cdn.jsdelivr.net/npm/three-globe/example/img/earth-topology.png')
					.pathsData(gData.map(d => d.path))
					.pathColor(() => 'rgba(0,255,0,0.6)') // Green for the rocket launch path
					.pathDashLength(0.05)
					.pathDashGap(0.02)
					.pathDashAnimateTime(10000)
					.pathStroke(10)
					.labelsData(filtered_launches.lat.map((lat, i) => ({
						lat: lat - 1, 
						lng: filtered_launches.lon[i], 
						name: `Launch ${filtered_launches.id[i]}`,  // Label is based on launch ID
						})))
					.labelLat(d => d.lat)
					.labelLng(d => d.lng)
					.labelText(d => d.name)  // Label the location with the launch ID
					.labelResolution(2)
					.labelSize(1.5)
					.labelDotRadius(0);

					setTimeout(() => {
					globe
						.pathPointAlt(pnt => pnt[2]) // Set altitude accessor
						.pathTransitionDuration(5000) // Smooth transition in altitude
						.pointOfView({ lat: 0, lng: 0, altitude: 1.9 }, 1000);
					}, 1000);

					// Function to resize the globe based on its container size
					const resizeGlobe = () => {
						const container = document.getElementById('globeplot');
						
						// Set the width and height of the globe based on the container's size
						globe.width(container.offsetWidth).height(container.offsetHeight);
						
						// Manually reset the canvas element size to match the container size
						const canvas = document.querySelector('canvas');
						canvas.style.width = `${container.offsetWidth}px`;
						canvas.style.height = `${container.offsetHeight}px`;
						canvas.style.transform = 'none';
					};

					// Resize the globe on window resize
					window.addEventListener('resize', resizeGlobe);

					// Trigger the resize immediately after the globe is initialized
					resizeGlobe();
				}

				function updateTables(filtered_launches) {
					
					const table1Body = document.getElementById('launchTableBody');
					const table1Foot = document.getElementById('launchTableFoot');
					table1Body.innerHTML = '';
					table1Foot.innerHTML = '';
					let totalBC = 0, totalCO = 0, totalCO2 = 0, totalH2O = 0;
					let totalAl2O3 = 0, totalCly = 0, totalNOx = 0;
					filtered_launches.id.forEach((location, index) => {
						const row = document.createElement('tr');
						const BC = filtered_launches.BC[index];
						const CO = filtered_launches.CO[index];
						const CO2 = filtered_launches.CO2[index];
						const H2O = filtered_launches.H2O[index];
						const Al2O3 = filtered_launches.Al2O3[index];
						const Cly = filtered_launches.Cly[index];
						const NOx = filtered_launches.NOx[index];
						totalBC    += BC;
						totalCO    += CO;
						totalCO2   += CO2;
						totalH2O   += H2O;
						totalAl2O3 += Al2O3;
						totalCly   += Cly;
						totalNOx   += NOx;
						row.innerHTML = `
							<td>${filtered_launches.date[index]}</td> 
							<td>${location}</td>  
							<td>${filtered_launches.time[index].toFixed(2)}</td> 
							<td class="wrap-text">${filtered_launches.text[index]}</td> 
							<td class="wrap-text">${filtered_launches.rocket[index]}</td> 
							<td>${filtered_launches.smc[index]}</td> 
							<td>${filtered_launches.BC[index].toFixed(1)}</td> 
							<td>${filtered_launches.CO[index].toFixed(1)}</td> 
							<td>${filtered_launches.CO2[index].toFixed(1)}</td> 
							<td>${filtered_launches.H2O[index].toFixed(1)}</td> 
							<td>${filtered_launches.Al2O3[index].toFixed(1)}</td> 
							<td>${filtered_launches.Cly[index].toFixed(1)}</td> 
							<td>${filtered_launches.NOx[index].toFixed(1)}</td> 
						`;
						table1Body.appendChild(row);
					});
					// Add Totals to Launch Table
					const totalRow1 = document.createElement('tr');
					totalRow1.innerHTML = `
						<td>Total</td>
						<td>-</td>
						<td>-</td>
						<td>-</td>
						<td>-</td>
						<td>-</td>
						<td>${totalBC.toFixed(1)}</td>
						<td>${totalCO.toFixed(1)}</td>
						<td>${totalCO2.toFixed(1)}</td>
						<td>${totalH2O.toFixed(1)}</td>
						<td>${totalAl2O3.toFixed(1)}</td>
						<td>${totalCly.toFixed(1)}</td>
						<td>${totalNOx.toFixed(1)}</td>
					`;
					table1Foot.appendChild(totalRow1);
				}

				function updateMaps(filtered_launches) {
					const latitudes1 = filtered_launches.lat;
					const longitudes1 = filtered_launches.lon;
    				const labels1 = filtered_launches.id;

					const mapData1 = latitudes1.length > 0 && longitudes1.length > 0 ? [{
						type: 'scattergeo',
						lat: latitudes1,
						lon: longitudes1,
						text: labels1,
						mode: 'markers+text',
						marker: {
						size: 12,
						color: 'blue',
						symbol: 'x',
						},
						textfont: {
							size: 15,  // Font size for the labels
							color: 'black',  // Color of the text
							weight: 'bold',
						},
						textposition: 'right',
					}] : [{
						type: 'scattergeo',
						mode: 'markers', // Keep the map but without data points
						marker: { size: 0 }, // Invisible markers
					}];

					// Common layout configuration
					const commonLayout = {
						geo: {
							resolution: 100, 
							projection: { type: 'robinson' },
							showland: true,
							landcolor: 'rgb(217, 217, 217)',
							showocean: true,
							oceancolor: 'rgb(204, 233, 255)',
							showcountries: true,
							countrycolor: 'rgb(50, 50, 50)',
							showsubunits: true,
							subunitcolor: 'rgb(150, 150, 150)',
							showgrid: true,
							gridcolor: 'rgb(220, 220, 220)',
							gridwidth: 2,
							griddash: 'dash', // Dashed gridlines for both axes
							lataxis: {
								showgrid: true,  // Gridline for latitude axis
								gridcolor: 'rgb(220, 220, 220)', // Optional: specify grid color
								griddash: 'dash', // Dashed gridline style
								tickmode: 'array',
								ticks: '',
								ticklen: 10,
								tickcolor: 'rgb(220, 220, 220)',
								showticklabels: false,
								zeroline: false
							},
							lonaxis: {
								showgrid: true,  // Gridline for longitude axis
								gridcolor: 'rgb(220, 220, 220)', // Optional: specify grid color
								griddash: 'dash', // Dashed gridline style
								tickmode: 'array',
								ticks: '',
								ticklen: 10,
								tickcolor: 'rgb(220, 220, 220)',
								showticklabels: false,
								zeroline: false
							}
						},
						margin: { t: 50, b: 0, l: 0, r: 0 }, // Adjust top margin for title
						title: { font: { size: 18 }, xanchor: 'center', yanchor: 'top', y: 0 }, // Adjust title position
					};

					// Add individual titles
					const layout1 = { ...commonLayout, title: { text: 'Launches', font: { size: 18 } }};

					// Render the maps with their legends
					Plotly.newPlot('map1', mapData1, layout1);
				}
				
				function updateGraph(filtered_launches) {

					let totalBC = 0, totalCO = 0, totalH2O = 0;
					let totalAl2O3 = 0, totalCO2 = 0, totalCly =0;
					let totalNOx = 0;
					filtered_launches.id.forEach((location, index) => {
						const row = document.createElement('tr');
						const BC    = filtered_launches.BC[index];
						const CO    = filtered_launches.CO[index];
						const CO2   = filtered_launches.CO2[index];
						const H2O   = filtered_launches.H2O[index];
						const Al2O3 = filtered_launches.Al2O3[index];
						const Cly   = filtered_launches.Cly[index];
						const NOx    = filtered_launches.NOx[index];
						totalBC    += BC;
						totalCO    += CO;
						totalCO2   += CO2;
						totalH2O   += H2O;
						totalAl2O3 += Al2O3;
						totalCly   += Cly;
						totalNOx   += NOx;
					});
					
					// Prepare the data for Plotly
					const labels = ['BC', 'CO', 'CO<sub>2</sub>', 'H<sub>2</sub>O', 'Al<sub>2</sub>O<sub>3</sub>','Cl<sub>y</sub>', 'NO<sub>x</sub>'];
					const data = [totalBC, totalCO, totalCO2, totalH2O, totalAl2O3, totalCly, totalNOx];
					const maxYValue = Math.max(...data);

					const trace = {
						x: labels,
						y: data,
						type: 'bar',  // Bar chart (you can change to line, pie, etc.)
						marker: {
							color: 'rgba(75, 192, 192, 0.7)'
						}
					};
					
					const layout = {
						title: `Emissions between ${startDate} and ${endDate}`,
						xaxis: {
							title: 'Compound',
							font: {
								color: 'green', // Set x-axis label color
								size: 14        // x-axis font size
							}
						},
						yaxis: {
							title: 'Mass [t]',
							range: [0,maxYValue]
						},
						autosize: true,  // Automatically resize the chart
						responsive: true // Ensure the chart resizes with the window
					};

					// Plot the chart inside the 'emissionsChart' div
					Plotly.newPlot('bar1', [trace], layout);

				}
				
				// Plot a default date when the page opens, then update when the date changes.
				document.addEventListener('DOMContentLoaded', () => {
					
					const datePicker1 = document.getElementById('datePicker1'); // Start date picker
					const datePicker2 = document.getElementById('datePicker2'); // End date picker

					datePicker1.value = startDate;
					datePicker2.value = endDate;
					fetchEventsData(); // Fetch data for the default date

					// Event listeners for date pickers
					datePicker1.addEventListener('change', (event) => {
						startDate= event.target.value;
						if (startDate) {
							fetchEventsData();
						}
					});
					datePicker2.addEventListener('change', (event) => {
						endDate = event.target.value;
						if (endDate) {
							fetchEventsData();
						}
					});

					document.getElementById('applyFilters').addEventListener('click', () => {
						toggleContainer('globe');
						filterlaunches(all_launches);
					});
				});

				document.getElementById('globeplot').addEventListener('mousedown', stopRotation);
				document.getElementById('globeplot').addEventListener('wheel', stopRotation);
				document.getElementById('globeplot').addEventListener('touchstart', stopRotation);
				
				rotateGlobe();
				checkInactivity();

			</script> 
			<br>
			<a href="#">Go to Top</a>
			<br>
			<br>
			<h2>Frequently Asked Questions</h2>

			<div id="faqs-container"></div>

				<script>
					const faqData = [ 
						{ question: "What are these chemicals? ",
						answer: "NO<sub>x</sub> is nitrogen oxides, H<sub>2</sub>O is water vapour, CO<sub>2</sub> is carbon dioxide, BC is black carbon or soot, Al<sub>2</sub>O<sub>3</sub> is aluminium oxide or alumina, and Cl<sub>y</sub> is a family of chlorine compounds. NO<sub>x</sub>, H<sub>2</sub>O, CO<sub>2</sub>, and Cl<sub>y</sub> are released as gases, BC and Al<sub>2</sub>O<sub>3</sub> as particles."
						},
						{ question: "How do these chemicals affect the atmosphere?",
						answer: "Unlike man-made emissions from the surface of the Earth, rocket launches release air pollutant and CO<sub>2</sub> emissions throughout the atmosphere, where they can have an outsized impact on our atmosphere and climate. NO<sub>x</sub> and Cl<sub>y</sub> are the largest contributors to destruction of the ozone layer from rocket emissions, with smaller destruction occuring from emissions of BC and Al<sub>2</sub>O<sub>3</sub> particles. The largest climate impacts come from BC emissions, which warm the upper layers of the atmosphere while cooling the lower layers."
						},
						{ question: "What does each filter represent?",
						answer: "Launch site refers to the location of the rocket launch. Launch vehicle refers to the type of rocket used for the launch. Megaconstellation refers to whether the launch contains megaconstellation payloads."
						},
						{ question: "How is this data calculated?",
						answer: "Our calculations are based on the current best scientific knowledge available for emissions from rocket launches. We include the effects of a changing chemical environment with altitude in our launch emissions, and calculate emissions globally up to a maximum altitude of 80 km. Paths shown in the Globe view are fixed at the launch site and do not represent real rocket trajectories."
						},
						{ question: "Where can I find the original methodology and data?",
						answer: "You can find further details in our study published in Nature Scientific Data: Global 3D rocket launch and re-entry air pollutant and carbon dioxide emissions for 2020-2022</strong>. C. R. Barker, E. A. Marais (2024). doi:10.5522/04/26325382. [<a href='https://doi.org/10.5522/04/26325382' target='_blank' rel='noopener noreferrer'>Data</a>]. [<a href='https://www.nature.com/articles/s41597-024-03910-z' target='_blank' rel='noopener noreferrer'>Publication</a>]</p>"
						}
					];

					const faqsContainer = document.getElementById('faqs-container');

					faqData.map(function(item) {

						let article = document.createElement('article');
						article.classList.add('faq-item');

						const markup = `
								<div class="item-question">
									<span class="question-text">${item.question}</span>
									<span class="arrows-container">
										<span class="expand">▼</span>
										<span class="close">▲</span>
									</span>
								</div>
								<div class="item-answer">
									<span>${item.answer}</span>
								</div>
						`;
						
						article.innerHTML = markup;
						faqsContainer.append(article);
					});

					const toggleButtons = document.querySelectorAll('.arrows-container');
						
					toggleButtons.forEach(button => {
						button.addEventListener('click', function(e) {
							const faqItem = e.currentTarget.parentElement.parentElement;
							faqItem.classList.toggle("show-answer");
						});
					});

				</script>

				<p>
					Developed by <a href="https://profiles.ucl.ac.uk/93616-connor-barker" target="_blank" rel="noopener noreferrer">Connor Barker</a> (UCL postdoc) and <a href="https://profiles.ucl.ac.uk/77783-eloise-marais" target="_blank" rel="noopener noreferrer">Eloise Marais</a> (UCL PI), in collaboration with <a href="https://www.cfa.harvard.edu/people/jonathan-mcdowell" target="_blank" rel="noopener noreferrer">Jonathan McDowell</a> (Harvard-Smithsonian Center for Astrophysics). Interested in using the data or spot any room for improvements? Please reach out to Connor Barker at <a href= "mailto:name@email.com">connor.barker@ucl.ac.uk</a>.
				</p>
				<p>
					<strong>Funding Disclaimer:</strong> This project has received funding from the European Research Council (ERC) under the European Union’s Horizon 2020 research and innovation programme (grant agreement No. 851854). <a href="https://cordis.europa.eu/project/id/851854" target="_blank" rel="noopener noreferrer">European Commission project page</a>.
				</p>
			</div>
		</div>
	</div>
</div>

<hr />
<div id="footer">
<!-- If you'd like to support WordPress, having the "powered by" link somewhere on your blog is the best way; it's our only promotion or advertising. -->
	<p>
		<br> <br />
		<!-- 20 queries. 0.067 seconds. -->
	</p>
</div>
<!-- Gorgeous design by Michael Heilemann - http://binarybonsai.com/kubrick/ -->
<script type="text/javascript' src='./js/wp-embed.min.js"></script>
</body>
</html>